// https://www.youtube.com/watch?v=J0LMSzv90W0

var fxcr_pos[4] = 0x90, fxcr_dir;

data fxcr_g012 {
    nocross

    0x00 0x00 0x00 0x01 0x03 0x07 0x07 0x0e 0x0e 0x1e 
    0x1e 0x1c 0x1c 0x3c 0x3c 0x3c 0x3c 0x3c 0x3c 0x3c 
    0x38 0x38 0x18 0x18 0x0c 0x0e 0x0e 0x07 0x03 0x01 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0xff 0xff 0xc0 0x80 0x00 0x00 0x07 0x03 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xc0 0xf0 
    0xf8 0x7e 0x3f 0x0e 0x00 0x00 0x00 0x00

    0x00 0x00 0xf8 0xfc 0x1c 0x1c 0x1c 0x3e 0xff 0xff 
    0x00 0x07 0x0f 0x0c 0x18 0x18 0x30 0x31 0x31 0x30 
    0x30 0x30 0x3f 0x1f 0x00 0x00 0x00 0x00 0x01 0x01 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0x01 0x03 0x07 0x07 0x07 0x03 0xe1 0xc0 
    0x00 0xe3 0xf3 0x1b 0x1b 0x1b 0x1b 0x9b 0x9b 0x1b 
    0x13 0x33 0xf3 0x83 0x03 0x03 0x03 0x03 0xf3 0xfb 
    0x1f 0x0f 0x07 0x03 0x03 0x00 0x00 0x00

    0x00 0x3f 0xff 0x80 0x80 0x00 0x00 0x80 0xe0 0xf0 
    0x38 0x1c 0x0e 0x07 0x03 0x01 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x70 0x70 0x60 0x60 0x60 
    0x60 0x30 0x18 0x0f 0x03 0x00 0x00 0x00

    0x00 0xf8 0xfc 0x0e 0x07 0x03 0x03 0x03 0x00 0x00 
    0x00 0x00 0x00 0x00 0x80 0xc0 0xe0 0x70 0x30 0x38 
    0x18 0x1c 0x0c 0x0c 0x0c 0x0c 0x0c 0x0c 0x0c 0x0c 
    0x0c 0x0c 0x18 0x30 0xe0 0x00 0x00 0x00
}

data fxcr_glafouk {
    nocross

    0x00 0x00 0x00 0x1f 0x1f 0x39 0x39 0x39 0x39 0xe1 
    0xe6 0xe7 0xe7 0xee 0xee 0xee 0xee 0xee 0xee 0xee 
    0xee 0xee 0xee 0xee 0xee 0xee 0xee 0xee 0xee 0xee 
    0xee 0xee 0xee 0xe0 0x3f 0x3f 0x00 0x00

    0x00 0x00 0x00 0xc0 0xc0 0xc0 0xc0 0xc0 0xc0 0xc0 
    0xe0 0xf0 0xf0 0x06 0x7e 0xfc 0xcc 0xcb 0xfb 0x7b 
    0x0b 0xcb 0xfb 0x73 0x03 0x03 0x03 0x03 0x03 0x03 
    0x02 0x03 0x03 0x03 0x01 0xe0 0x00 0x00

    0x00 0x00 0x0f 0x1f 0x1e 0x1c 0x3c 0x38 0x38 0x38 
    0x30 0x30 0x30 0x07 0x0e 0x18 0x70 0x70 0x60 0x60 
    0xf3 0xff 0x00 0x00 0x00 0x00 0x60 0xe0 0xc0 0x80 
    0x00 0xff 0xff 0xff 0xfe 0x00 0x00 0x00

    0x00 0x00 0xff 0xff 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0xf0 0x30 0x30 0x30 0x30 0x70 0xe0 
    0xc0 0x80 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0xc0 0xc0 0x80 0x00 0x00 0x00 0x00

    0x00 0x00 0xe0 0xe0 0x60 0x61 0x61 0x61 0x63 0xe3 
    0xe3 0xe7 0xe7 0x46 0x0e 0x0e 0x0f 0x1f 0x1f 0x1b 
    0x19 0x19 0x39 0x31 0x71 0x70 0x70 0x70 0x60 0x60 
    0x60 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0xc0 0xc0 0xc0 0x80 0x80 0x80 0x80 0x00 
    0x00 0x00 0x03 0x0f 0x1e 0x78 0xf0 0xc0 0x00 0x80 
    0x80 0xc0 0xc0 0xc0 0xe0 0xe0 0xe0 0xe0 0xe0 0x60 
    0x60 0x00 0x00 0x00 0x00 0x00 0x00 0x00
}

data fxcr_flewww {
    nocross

    0x00 0x00 0x00 0x03 0x03 0x07 0x07 0x0e 0x0e 0x18 
    0x18 0x38 0x38 0x38 0x30 0x30 0x30 0x30 0x30 0x30 
    0x70 0x70 0x30 0x7f 0xf0 0x78 0x70 0x70 0x70 0x30 
    0x18 0x18 0x0f 0x00 0x00 0x00 0x00 0x00

    0x00 0xe0 0xc0 0x80 0x83 0x07 0x66 0x66 0x66 0x67 
    0x37 0x33 0x3b 0x3b 0x1b 0x19 0x18 0x18 0x1c 0x1c 
    0x1c 0x0c 0xcc 0xcc 0x0c 0x0e 0x06 0x06 0x07 0x07 
    0x00 0x00 0xc0 0xff 0xfc 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0xfe 0xfe 0x00 0x00 0xfc 0xfe 
    0x83 0x03 0x03 0x06 0xfc 0xfc 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x40 0xe0 0x00 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0x00 0x33 0x37 0x76 0x7f 0x7b 
    0x79 0x69 0xe1 0xe1 0x01 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x19 0x1b 0x3f 0x36 0x60 0x60 0x60 0x60 0x80 
    0x80 0x80 0x80 0x80 0x80 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x80 0x80 0xc0 0xc0 0xc0 0xc0 0xc0 0xc0 0xcc 
    0xdc 0x1f 0x3f 0x6b 0x63 0xc3 0xc3 0x03 0x03 0x01 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
}

data fxcr_poke {
    nocross

    0x00 0x60 0x60 0x60 0x60 0x61 0x61 0x61 0x63 0x63 
    0x63 0x63 0x63 0x63 0xe3 0xe3 0xe3 0x61 0x60 0x60 
    0x7f 0x7f 0x7f 0x60 0x60 0x60 0x60 0x60 0x60 0x60 
    0x60 0x60 0x30 0xff 0xf0 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0xff 0xff 0xf0 0x80 0x00 0x00 
    0x06 0x06 0x00 0x00 0x80 0x80 0xff 0xff 0x00 0x00 
    0x80 0xff 0xff 0x0f 0x01 0x01 0x01 0x01 0x01 0x01 
    0x03 0x7f 0xfe 0xf0 0x00 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0xe0 0xf0 0x78 0x18 0x18 0x19 
    0x19 0x19 0x19 0x39 0x19 0x79 0xf1 0xc1 0x03 0x03 
    0x03 0x03 0x03 0x86 0x86 0xc6 0xc6 0xc6 0x8e 0x8e 
    0x80 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0x00 0xe0 0xe0 0xe1 0xe3 0xc6 
    0xce 0x9c 0xf8 0xe0 0xc0 0xf0 0x38 0x1c 0x0e 0x06 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x80 0x80 0x07 
    0x1f 0x38 0x70 0x70 0x7f 0x7f 0x70 0x30 0x30 0x30 
    0x18 0x18 0x1e 0x0f 0x07 0x07 0x01 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00

    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00 0xf8 
    0xf8 0x00 0x00 0x00 0x00 0x80 0xc0 0x20 0x20 0x20 
    0x30 0x30 0x30 0x30 0x30 0xe0 0xe0 0x00 0x00 0x00 
    0x00 0x00 0x00 0x00 0x00 0x00 0x00 0x00
}

func fxcr_setsprite_g012 {
    s1=a=&<fxcr_g012 s1+1=a=&>fxcr_g012
    s2=a=&<fxcr_g012+38 s2+1=a=&>fxcr_g012+38
    s3=a=&<fxcr_g012+76 s3+1=a=&>fxcr_g012+76
    s4=a=&<fxcr_g012+114 s4+1=a=&>fxcr_g012+114
    s5=a=&<fxcr_g012+152 s5+1=a=&>fxcr_g012+152
    s6=a=&<fxcr_g012+190 s6+1=a=&>fxcr_g012+190
}
func fxcr_setsprite_glafouk {
    s1=a=&<fxcr_glafouk s1+1=a=&>fxcr_glafouk
    s2=a=&<fxcr_glafouk+38 s2+1=a=&>fxcr_glafouk+38
    s3=a=&<fxcr_glafouk+76 s3+1=a=&>fxcr_glafouk+76
    s4=a=&<fxcr_glafouk+114 s4+1=a=&>fxcr_glafouk+114
    s5=a=&<fxcr_glafouk+152 s5+1=a=&>fxcr_glafouk+152
    s6=a=&<fxcr_glafouk+190 s6+1=a=&>fxcr_glafouk+190
}
func fxcr_setsprite_flewww {
    s1=a=&<fxcr_flewww s1+1=a=&>fxcr_flewww
    s2=a=&<fxcr_flewww+38 s2+1=a=&>fxcr_flewww+38
    s3=a=&<fxcr_flewww+76 s3+1=a=&>fxcr_flewww+76
    s4=a=&<fxcr_flewww+114 s4+1=a=&>fxcr_flewww+114
    s5=a=&<fxcr_flewww+152 s5+1=a=&>fxcr_flewww+152
    s6=a=&<fxcr_flewww+190 s6+1=a=&>fxcr_flewww+190
}
func fxcr_setsprite_poke {
    s1=a=&<fxcr_poke s1+1=a=&>fxcr_poke
    s2=a=&<fxcr_poke+38 s2+1=a=&>fxcr_poke+38
    s3=a=&<fxcr_poke+76 s3+1=a=&>fxcr_poke+76
    s4=a=&<fxcr_poke+114 s4+1=a=&>fxcr_poke+114
    s5=a=&<fxcr_poke+152 s5+1=a=&>fxcr_poke+152
    s6=a=&<fxcr_poke+190 s6+1=a=&>fxcr_poke+190
}

data fxcr_colup {
    for x=0..127 eval [ 0x90+round(sin(x*3.14/128)*7)*2 ]
    for x=0..127 eval [ 0 ]

    for x=0..31 eval [0]
    for x=0..127 eval [ 0x40+round(sin(x*3.14/128)*7)*2 ]
    for x=0..95 eval [0]

    for x=0..63 eval [0]
    for x=0..127 eval [ 0x60+round(sin(x*3.14/128)*7)*2 ]
    for x=0..63 eval [0]

    for x=0..95 eval [ 0 ]
    for x=0..127 eval [ 0xc0+round(sin(x*3.14/128)*7)*2 ]
    for x=0..31 eval [0]
}

data fxcr_div3 {
    nocross
    for x=0..111 eval [ ((floor((x)/3))&0x3F) | (floor(x%3)<<6) ]
}

func fxcr_slide {
    nocross {
        a=&>fxcr_slidestart a!!
        a=x=fxcr_div3,y a&0x3f c- a+&<fxcr_slidestart a!!
        wsync
fxcr_slidestart:
        return
        a?0xc9 a?0xc9 a?0xc9 a?0xc9 a?0xc9 
        a?0xc9 a?0xc9 a?0xc9 a?0xc9 a?0xc9 
        a?0xc9 a?0xc9 a?0xc9 a?0xc9 a?0xc9 
        a?0xc9 a?0xc9 a?0xc5 *
    }
}

func fxcr_setpos {
    fxcr_slide *6 RESP1=RESP0=a
    a=x a>> a>> a&0x30 HMP0=a a+0x10 HMP1=a wsync hmove
}

func fx_credits_init
{
    NUSIZ0=NUSIZ1=a=[THREE_COPIES_CLOSE]
    VDELP0=VDELP1=a=[VDEL_ENABLE]

    fxcr_dir=a=0
    fxcr_pos+2=fxcr_pos=a=0
    fxcr_pos+3=fxcr_pos+1=a=0x69
    PF0=PF1=PF2=a=0xff
    GRP0=GRP1=GRP0=a=0
}

func fxcr_draw {
    nocross {
        x=38 tmp=x fxcr_slide *31
        {
            *6 y=tmp
            GRP0=a=(s1),y GRP1=a=(s2),y GRP0=a=(s3),y
            tmp+1=a=(s6),y a=(s5),y x=a a=(s4),y y=tmp+1
            GRP1=a GRP0=x GRP1=y GRP0=x
            tmp--
        }!=
        GRP0=GRP1=GRP0=a=0
    }
}

func fx_credits_kernel
{
    y=time COLUP0=COLUP1=a=fxcr_colup,y       y=fxcr_pos   fxcr_setpos fxcr_setsprite_flewww  fxcr_draw
    y=time COLUP0=COLUP1=a=fxcr_colup+0x100,y y=fxcr_pos+1 fxcr_setpos fxcr_setsprite_g012    fxcr_draw
    y=time COLUP0=COLUP1=a=fxcr_colup+0x200,y y=fxcr_pos+2 fxcr_setpos fxcr_setsprite_glafouk fxcr_draw
    y=time COLUP0=COLUP1=a=fxcr_colup+0x300,y y=fxcr_pos+3 fxcr_setpos fxcr_setsprite_poke    fxcr_draw
}

func fx_credits_overscan
{
    a=1 a&?fxcr_dir
    =={
        fxcr_pos++ a=fxcr_pos a?0x67 =={fxcr_dir++}
        fxcr_pos+1--
        fxcr_pos+2=a=fxcr_pos
        fxcr_pos+3=a=fxcr_pos+1
        return
    }
    fxcr_pos-- a=fxcr_pos a?1 =={fxcr_dir++}
    fxcr_pos+1++
    fxcr_pos+2=a=fxcr_pos
    fxcr_pos+3=a=fxcr_pos+1
}


